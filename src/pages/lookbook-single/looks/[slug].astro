---
import LegacyHtmlPage from "../../../components/LegacyHtmlPage.astro";
import { getLegacyPageBySourcePathname } from "../../../lib/legacy-pages";
import {
  legacySingleSlashLookbook404Paths,
  extractLookbookSlug,
} from "../../../data/legacyLookbook";

export function getStaticPaths() {
  const removeTrailingSlash = (pathname: string) =>
    pathname.length > 1 ? pathname.replace(/\/+$/, "") : pathname;

  return legacySingleSlashLookbook404Paths.map((path) => {
    const sourcePathname = removeTrailingSlash(path);
    const page = getLegacyPageBySourcePathname(sourcePathname);
    if (!page) {
      throw new Error(`Missing legacy page for single-slash lookbook path: ${sourcePathname}`);
    }

    return {
      params: {
        slug: extractLookbookSlug(path),
      },
      props: {
        rawHtml: page.rawHtml,
      },
    };
  });
}

const { rawHtml } = Astro.props;
---

<LegacyHtmlPage rawHtml={rawHtml} />
